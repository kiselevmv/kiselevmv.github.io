---
layout: post
title:  "Как работать без прав администратора на компьютере"
date: 2016-08-31 13:28:00 -0000
tags: lifehack
---

Компании стремятся выдать работникам ровно столько прав для работы с компьютером, сколько считают необходимым и безопасным. И почти всегда это меньше, чем реально нужно для работы. Отсутствие тех или иных прав суперпользователя для управления компьютером мешает работе, так как много времени уходит на решения банальных вопросов или просто невозможно выполнить какую-то работу. Здесь я постараюсь описать, что можно сделать, чтобы чуть улучшить своё положение. Это статья инженера, а не дизайнера или программиста. Так что здесь приведены не все возможные советы, некоторые не будут работать из-за конкретных политик безопасности, принятых в вашей компании, а некоторые ваш работодатель может рассматривать как нарушение какой-нибудь корпоративной процедуры. Так что все указанные ниже вещи нужно делать на свой страх и риск, прочитав предварительно правила компании по безопасности. Впрочем, большинство мест, где я работал, никаких подобных правил не имели, так что лучше просто переговорить с системным администратором.

# Как это начинается

Итак, вы начали работу инженера (программиста, дизайнера, дальше подставьте сами). Компания доверила вам разрабатывать что-то, внедрять что-то, выполнять какую-то работу и ожидает, что вы будете делать это самым эффективным способом. Вы познакомились с начальником и коллегами, нашли кофе-машину и горите энтузиазмом или, хотя бы, испытываете сдержанное удовлетворение по поводу того, чем и с кем вам придётся заниматься по 8-10 часов в день.

И вот вам выдали ноутбук или посадили за настольный компьютер. Вы знакомитесь с корпоративным сайтом, сетевыми ресурсами и смотрите, что же установлено на вашем компьютере. Скорее всего, вы при этом пытаетесь настроить его под себя. Если у вас "тонкий клиент" - дальше можно не читать. Хорошо, если вы сможете поменять обои. И с этим совсем ничего не поделать, никак. Но если это обычный компьютер под управлением одной из версий Windows, кое-какие настройки без полномочий администратора компьютера сделать можно.

# Что же можно сделать?

Есть много способов сделать настройки компьютера, которые на первый взгляд, требуют прав админа не обладая ими. Например, в моей компании есть портал самообслуживания, где можно установить кое-какие нужные программы (список очень ограниченный), заказать установку специфических программ с одобрением менеджера или даже заказать установку чего-то, чего нет в стандартном перечне, с необходимым обоснованием необходимости. В других случаях можно использовать альтернативные методы настройки Windows, приведенные ниже. Да, все эти трюки работают только для пользователей Windows, но ведь подавляющее большинство из вас использует именно эту операционную систему.

Итак, что же можно сделать.

## Установка программ

В зависимости от того, какие программы вы используете - есть несколько разных путей. Например, если программное обеспечение коммерческое, а многие бесплатные программы всё же требуют лицензии для коммерческого использования - у вас нет выбора. Нужно как-то обосновать руководству необходимость приобретения лицензии. Причём покупка какой-нибудь мелочи за 600 руб может быть ничем не проще покупки программного комплекса за 600 000 руб, придётся пройти те же круги согласований и оплаты.

Если программа бесплатна и для коммерческого использования - у вас есть несколько способов использовать её на своём компьютере.

## Способ 1 - искать уже готовую переносимую версию программы

Некоторые программы распространяются авторами сразу в том варианте, который не требует установки или не требует прав администратора для установки. Обычно это называется переносимая программа или portable сборка программы. Устоявшегося русскоязычного аналога этому слову нет. Просто зайдите на сайт программы и поищите, не предлагают ли подобную вариант программы авторы. Если они не озаботились portable вариантом - может быть это сделал кто-то другой. Этот вариант похуже, ведь все программы имеют свою лицензию, устанавливающие ограничения на то, чего нельзя делать с программой. И часто это ограничение касается изменения программы. Но всё же многие могут быть переделаны вполне легально. Поищите нужные программы на сайтах [Portable Apps](http://portableapps.com/ru), [Make use of](http://www.makeuseof.com/tag/best-portable-apps/), [Pendriveapps](http://www.pendriveapps.com/) или просто поискать в интернете "название программы" + portable. Вероятность успеха довольно высока.

## Способ 2 - сделать portable программу на рабочем месте

Вот ваш незаменимый инструмент - [Universal Extractor](http://legroom.net/software/uniextract). Поскольку он не обновлялся с 2010 года и современные установочные файлы не открывает - предлагаю скачать более новую [бета версию UniExtractor](https://github.com/Bioruebe/UniExtract2/releases). Он поможет решить большинство проблем с установкой программ. Скачиваете архив с программой. Его можно распаковать в любую папку на компьютере, куда у вас есть права доступа. Предположим, вам удалось создать каталог `C:\Apps\` и есть чем распаковать скачанный zip архив. Программа UniExtract работает очень просто - она пытается извлечь установочные файлы из exe или msi файла, предназначенного для установки программ.

Очень многие программы будут работать, даже если их просто извлекли из дистрибьютива, а не установили обычным способом. Мне удалось использовать таким образом:

1. Evernote
2. XPdf
3. Fopydo
4. Nitro

Будет программа работать или нет, если запускать её после извлечения из установочного файла - покажет только опыт, пробуйте.

## Способ 3 - сделать portable программу дома самому

Есть немало программ, которые позволяют сделать portable программу самостоятельно. Для использования любой из них нужен отдельный компьютер, где права администратора есть. Т.е. нужен домашний компьютер. Будет лучше, если версии Windows на рабочем и домашнем компьютере совпадают. Это не обязательное условие, но оно увеличивает шансы на успех. Если на компьютере, где изготавливается portable версия Windows ниже, чем на рабочем компьютере - это не должно быть проблемой. Если наоборот, делаем portable программу на старшей версии Windows для младшей - проблемы вероятнее. Наконец, худший случай, когда не совпадает разрядность версий Windows. Например, вы делаете на домашнем компьютере с 64-разрядной архитектурой portable программу для старого рабочего 32-разрядного компьютера. Этот случай самый проблематичный, шансы на успех минимальные.

Если всё это звучит для вас как иностранный язык - не проблема, просто попробуйте сделать portable сборку нужной программы как указано далее. Сам процесс - очень простой. Лично я использую [Cameyo](http://www.cameyo.com/). Базовые возможности этой программы бесплатны. Нужно просто [скачать](http://www.cameyo.com/download) клиент. Программа не требует установки. Просто запустите её перед тем, как устанавливать нужную программу. Появится окно.

![Cameyo](https://res.cloudinary.com/dlqc5rp9l/image/upload/v1624616843/blog/noadmin/cameyo_gefwds.png)

Вам нужна опция "Capture an installation", выберете её и нажмите OK. Программа исчезнет с рабочего стола, но останется запущенной. Нужно только подождать пару минут, пока Cameyo запоминает текущее состояние системы. Просто дождитесь, пока на экране появится такое окно. 

![Install done](https://res.cloudinary.com/dlqc5rp9l/image/upload/v1624616843/blog/noadmin/cameyo2_nswx3n.png) 

Теперь она будет следить за всем, что происходит с компьютером. Нужно установить нужную программу. При этом важно не делать ничего не относящегося к установке. Любые изменения в конфигурации компьютера Cameyo запомнит и посчитает связанными с установкой программы. Так что при запуске portable программы эти изменения в настройках будут выполнятся вновь. После завершения установки нужной программы имеет смысл сделать её первый запуск, зарегестрировать, если она требует регистрации, сделать нужные настройки. После этого закрыть программу, чтобы все нужные настройки, лицензии и т.п. сохранились и нажать на кнопку "Install done". Cameyo опять просканирует систему и создаст в каталоге "Мои документы" папку Cameyo, куда и сохранит новую программу. Это будет один исполняемый файл. Его можно переносить на флешке, передавать через интернет. Этот файл нужно запустить на компьютере, где не хватает администраторских прав. С довольно большой вероятностью успеха нужная программа запустится. Если она состоит из нескольких исполняемых файлов - Cameyo спросит, какой из них главный, какой нужно исполнять. Обычно это ясно из названий файлов, "главный" файл называется так-же, как сама программа или её сокращённое название. Сам Cameyo на компьютере без администраторских прав не нужен.

Это практически всё, что нужно знать. Если остаются вопросы - несложно найти ответы в интернете или спросить в комментариях к статье. Обычно я отвечаю на такие вопросы.

## Способ 4. Разместить программу на специальном сайте, где она будет выполняться уалённо

Этот способ самый сложный, не буду расписывать его здесь. Но потенциально он самый надёжный и универсальный. Есть службы, где программы могут быть установлены на удалённые сервера. Выполняются они там же, а взаимодействовать с ними можно через современный броузер. Такую возможность предоставляет рассмотренный выше [Cameyo](http://www.cameyo.com/) и другие подобные сервисы. Это всегда платная услуга, хотя можно найти временно бесплатные предложения.

Я такой способ не использовал, но попробовал его в рамках бесплатного месяца на одном из сервисов. Сложная программа, из которой не получалось сделать рабочую portable сборку заработала отлично. 

# Task Scheduler

Этот совет актуален не для всех, но хорошо бы иметь способ запускать задания на компьютере по расписанию. Многие вещи можно автоматизировать. Например, очистку временных папок, кэша броузера и подобные сервисные задачи. Я использую программу, которая называется <a href="https://www.npmjs.com/package/runnjs">runn</a>. Её просто установить, а задачи для регулярного запуска заносятся в текстовый файл с настройками. Выглядит он так:

    00 00,30    powershell C:\Users\kuzzmi\script.ps1

Теперь [runn](https://www.npmjs.com/package/runnjs) будет запускать этот скрипт каждые пол-часа. Разумеется, все задачи запускаются с правами пользователя и не могут сделать ничего, для чего недостаточно этих прав.

# Установка шрифтов

У многих есть свои любимые шрифты. А для дизайнера и инженера это может быть особенно важным. Но даже эта опция может быть отключена. Тогда дожен выручить [RegisterFont](https://github.com/dcpurton/regfont). Это приложение для временной регистрации шрифтов. Т.е. все изменения в системе, которые делает программа, будут действовать до перезагрузки. Зато программа работает, даже если злобные администраторы лишили пользователя права устанавливать свои шрифты.

Чтобы всё работало - я сделал простой командный файл, для которого настроил автозагрузку.

    forfiles /s /m *.ttf /c "cmd /c regfont add <путь к файлам>"
    forfiles /s /m *.otf /c "cmd /c regfont add <путь к файлам>"

Файл регистрирует все шрифты по указанному пути и из подкаталогов.

# Создание "жёстких" ссылок

Помимо обычных ярлыков программ и файлов в Windows возможно создавать "жёсткие" ссылки. Они могут быть удобны. Например, по клику на обычном ярлыке файла или программы, созданном средствами виноус, можно только открыть их. Чтобы отправить файл по почте, отредактировать его сделать подобные вещи - нужно искать исходный файл. Это знает каждый, кто хоть раз получал по почте вместо файла ссылку на него. "Жёсткая" ссылка - это как второе имя файла. Таким образом, один и тот же файл может находиться находится сразу в нескольких каталогах. Это может быть удобным. Например, чтобы файл одновременно находился в файле с проектом, к которому он относится и в папке с текущими рабочими документами. Часто люди создают для этих целей две копии одного файла и потом бывают проблемы с тем, чтобы выяснить, какая копия более новая или изменения вносятся в разные копии одного файла, а потом приходится делать дополнительную работу, чтобы объединить их. Подробнее прочитать на русском языке про ссылки в Windows можно на [Geektimes](https://geektimes.ru/post/50878/#comment_1340462).

Нужно только помнить, что вторая ссылка - это "второе имя" одного и того же файла. Файл будет удалён только тогда, когда будет удалена последняя "жёсткая" ссылка на него. В этом отличие от "мягких" ссылок - ярлыков. В Windows нет удобного инструмента для создания и удаления  "жёстких" ссылок на файлы. Можно использовать для этих целей [FAR Manager](http://www.farmanager.com/). Среди прочих несомненных плюсов программы - возможность создавать ссылки на файлы, даже если у пользователя не хватает прав для этого. Непонятно, каким образом это работает, но факт остаётся фактом, при помощи FAR Manager можно делать ссылки на файлы, даже если права пользователя обрезаны до минимума. Для создания ссылки используются горячие клавиши Alt+F6.

Ссылки можно создавать только на дисках с файловой системой NTFS. Если ссылки не создаются - скорее всего, у вас используется файловая система FAT32. С этим ничего не поделать, с такой файловой системой можно делать только обычные ярлыки Windows.

Если не хочется заморачиваться установкой FAR Manager - можно делать ссылки из командной строки командой.

    mklink /H <link> <target>

link - имя ссылки, target - файл, на который делаем ссылку. Если нужна ссылка на папку с файлами - вместо ключа `/H` используем ключ `/J`. Если не указывать ключей - будет создана "мягкая", символическая ссылка. Например, на моём компьютере права установлены таким странным образом, что "жёсткие" ссылки создавать можно. А "мягкие" символические - нет. Но с FAR Manager можно всё.

# Почти идеальное решение - виртуальная машина

Использовать собственную виртуальную машину на которой можно запустить отдельный Windows или другую ОС кажется идеальным решением. Помочь в этом может [Portable VirtualBox](http://www.vbox.me/). К сожалению, это решение недоступно для большинства. В большинстве конфигураций хотя бы один запуск этого приложения должен быть сделан с правами администратора, чтобы установить необходимые для работы модули. Значит нужно будет каким-то образом договориться с администратором об однократном запуске. При этом каждый понимает, что над виртуальной машиной у администратора контроля не будет, значит туда можно будет установить любые пиратские программы и все причины по которым у пользователя отбирали права администратора не будут играть никакой роли.

# Изменение раскладки клавиатуры Windows

Большинство пользователей использует стандартную раскладку клавиатуры Windows. Но удобная, адаптированная под себя, раскладка клавиатуры может очень помочь в работе. Я использую альтернативную стандартную раскладку клавиатуры - Russian (Typewriter). Эта раскладка удобна тем, что знаки препинания "привязаны" к цифровым клавишам. Подразумевается, что знаки препинания пользователю приходится вводить куда чаще, чем цифры и это облегчает ввод. Цифры же можно вводить с нажатой клавишей Shift или используя цифровую клавиатуру. Раскладка почти идеальна для меня, но в ней нет возможности простого ввода символа "#", который я использую очень часто. У других пользователей могут быть другие часто используемые символы. Есть простые инструменты, позволяющие изменить раскладку клавиатуры под себя, но все они требуют повышенных привелегий доступа для своей работы. Программы SharpKeys, KeyTweak и Microsoft Keyboard Layout Creator хороши, только если у вас достаточно прав для пользования ими. Изменить раскладку под себя с правами обычного пользователя можно двумя способами.

## Использование программы Portable keyboard layout

[Portable keyboard layout](http://pkl.sourceforge.net/) - это программа, позволяющая полностью настроить под себя раскладку клавиатуры, при этом она не требует прав суперпользователя для использования. Она может быть удобна для программистов, т.к. настраиваются любые клавиши, можно изменить функции совершенно любой клавиши. Это очень мощный, но непростой инструмент. Я начал использовать эту программу, но мне она показалась избыточно сложной. 

## Использование программы AutoHotkey

[AutoHotkey](https://www.autohotkey.com/) - это очень мощный, но довольно простой инструмент, позволяющий настроить клавиатурные макросы, собственные горячие клавиши и многое-многое другое. Одна из функций программы - переназначение клавиш. Например, я "подвесил" на ненужный мне символ ```"|"``` очень нужный символ ```#```. Для этого создаём очень простой файл с расширением ahk.

    |::#

Теперь превращаем этот файл в исполняемый файл, который можно разместить в автостарте, чтобы он запускался при каждой загрузке виндоус. Для этого запускаем утилиту Ahk2Exe. Выбираем созданный файл, указываем, как будет называться итоговый файл. Остальные параметры можно не указывать. Нажимаем кнопку "Compile" и полученный файл перемещаем в папку автозапуска. Я создал файл с настройками AutoHotkey для себя и эти настройки очень помогают в работе.

# Используем веб-сервисы вместо программ

Это общая тенденция - всё чаще программу, устанавливаемую на компьютер можно заменить веб-сервисом. Для регулярно выполняемых операций это может быть неудобным, но для разовых манипуляций файлами удобнее использовать веб-сервис. Большой минус интернет-сервисов в том, что большинство из них работают по ежемесячной подписке. Это во многом обесценивает их, для регулярной работы лучше один раз купить нужную программу или найти бесплатную, а не пользоваться сервисом в интернете. Но многие сервисы работают бесплатно. Конечно, они показывают рекламу или имеют какие-либо ограничения на использование.

Приведу некоторые примеры веб-сервисов, которые заменяют программы. Новые сервисы появляются каждый день, поэтому я и не пытаюсь привести полный перечень.

- Программу для распознавания текстов FineReader можно заменить на её онлайн-вариант [FineReader Online](https://finereaderonline.com/ru-ru). До десяти страниц она распознаёт бесплатно, а этого вполне достаточно для разовой работы, когда нужно распознать текст договора или небольшого технического документа.

- Для операций с pdf-файлами можно использовать сайт [Small pdf](https://smallpdf.com/). Он позволяет выполнить многие операции - преобразовать pdf в другие форматы, разделить pdf файл на страницы или наоборот, объединить несколько файлов в один, повернуть pdf файл, защитить его паролем или наоборот, снять защиту. Этого вполне достаточно для большинства случаев.

- Сайт [Cloudconvert](https://cloudconvert.com/) позволяет преобразовывать множество разных форматов файлов друг в друга. Можно преобразовывать аудиофайлы, архивы, электронные книги, графические форматы, шрифты и т.п. Очень удобно, если нужно раскрыть архив в каком-нибудь экзотическом формате или открыть офисный файл, для которого нет нужной программы. Меня этот сервис спасал не раз.

- Есть даже онлайн графические редакторы. Я использовал [Pixlr editor](https://pixlr.com/editor/). Он имеет все необходимые стандартные инструменты для редактирования файлов и, конечно, он куда мощнее встроенного в Windows графического редактора Paint.

Я не буду продолжать список онлайн-сервисов, периодически я пользуюсь несколькими десятками. Для каких-то из них уже наверняка есть более удобные аналоги, про которые я не знаю. Наверное, за интернет-сервисами будущее. 

# И это не конец

Все эти обходные пути позволяют чуть облегчить себе работу в условиях жёстких ограничений. Существует множество других приёмов, позволяющих обойти разные ограничения. Многие из них можно найти в сети. Некоторые из них явно являются нарушением безопасности, например способы попасть на закрытые работодателем сайты, так что я не буду приводить их здесь.

Все карты в ваших руках, теперь можно использовать эти способы. Но и ответственность за их применение на вас.

Я сделал этот пост потому, что сам забываю некоторые вещи и должен заново искать подобные трюки, если меняю ноутбук/компьютер. Теперь этими способами можете воспользоваться и вы. Пишите комментарии, если у вас есть свои способы работать эффективно, когда корпоративные правила ограничивают со всех сторон.