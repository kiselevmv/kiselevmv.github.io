---
title:  "Читаем сводобно - 2"
date: 2019-06-29 12:45:00 -0000
tags: lifehack
---

Год назад я написал статью [Читаем свободно](/post/chitaem-svobodno). Как оказалось, за это время уже произошли некоторые изменения. Я пользуюсь Макбуком, поэтому нужно иметь в виду, что эти советы не работают точно также на компьютерах под управлением Windows. Я перешёл на единую программу для чтения книг на всех устройствах - [fbreader](https://fbreader.org/). На мой взгляд - это лучшая программа для чтения книг. К ней есть много плагинов. Она синхронизирует книги и позиции чтения книг между устройствами. Совершенно всеядна по форматам, она прочитает практически любую книгу. Работает на гаджетах под управлением iOS и Android, есть версии для настольных компьютеров и даже электронных книг. Не буду описывать дальше, но очень советую попробовать. 

Разумеется, мне опять потребовались версии книг со снятой DRM защитой из магазина книг Amazon. Речь идёт о купленных книгах, которые платформа не позволяет читать на других программах для чтения, кроме Kindle. За последний год произошли следующие изменения.

Во-первых, программа [DeDRM tools](https://github.com/apprenticeharper/DeDRM_tools/releases) теперь доступна на [Github](https://github.com). Отлично, больше не нужно искать и скачивать её из подозрительных источников, где можно подхватить верус или шифровальщик. 

Во-вторых, последние версии Kindle для Mac и для Windows изменили способ шифрования DRM книг. Теперь книги из программ версии 1.25 и выше не поддаются расшифровке. Очевидно, нужно устанавливать Kindle версии 1.24 и ниже. Скачивать Kindle reader предыдущих версий нужно в сети, т.е. опять же есть риск подцепить вирус или шифровальщик. 

В-третьих у Amazon изменился сам формат электроных книг. Т.е. даже после расшифровки будет получена книга в новом формате KFX. Как и с любым новым форматом - с ним будут проблемы с конверсией и чтением. Я не пытался читать или конвертировать эти книги. Вместо этого я скачал Kindle reader версии 1.17. Это последняя версия, в торорой используются старые форматы mobi и azw. Старые версии Kindle reader я скачал по ссылке из статьи [How to downgrade Kindle for PC v1.17 Kindle for Mac v1.17?](https://www.ebook-converter.com/222-drmexception-invalid-file-format.htm). 

Для работы DeDRM tools по-прежнему нужен python. На моём маке я поступил так. Установил brew - это менеджер пакетов для маков.

`mkdir homebrew && curl -L https://github.com/Homebrew/brew/tarball/master | tar xz --strip 1 -C homeb`

Более подробные инструкции [на странице проекта](https://docs.brew.sh/Installation). На мой взгляд - основной плюс brew в том, что он работает без полномочий администратора и устанавливает все программы с правами пользователя. Дальше нужно установить python и pip, если вы это конечно не сделали заранее. 

`brew install python pip`

Наконец, нужно установить библиотеку pycrypto без которой ничего не работает.

`sudo python -m pip install pycrypto`

Кроме того, мне пришлось установить библиотеку pylzma, но в руководстве пишут, что это нужно делать только если при расшифровке книг по-прежнему возникают ошибки.

`sudo python -m pip install pylzma`

Теперь достаточно перетаскивать шифрованные книги из кэша библиотеки Kindle на компьютере на иконку программы и она расшифрует их. Теперь книги можно кидать в библиотеку fbreader и они будут доступны для чтения везде. Думаю, было бы неплохо сконвертировать особо ценные книги в другой формат. Мне не нравится, как книги mobi и azw открываются в других читалках. Но это уже довольно сложная и нудная задача.

Если вы прочитали обе статьи "Читаем свободно", но у вас остались вопросы и что-то не работает - пишите в комментарии. Также вы можете найти ответы на многие вопросы в [FAQ по DeDRM tools](https://github.com/apprenticeharper/DeDRM_tools/blob/master/FAQs.md).
