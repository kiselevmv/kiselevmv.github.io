---
layout: post
title:  "Усвоенные уроки от подготовки книги в формате epub"
date: 2014-07-31 11:27:00 -0000
tags: lessons
---

Это нечто вроде lessons learned от подготовки книги "История свечи" в формате epub

1. Самый удобный визуальный редактор для исходной подготовки текста - Pages. Он может экспортировать файл в формат epub. Для MS Word есть дополнения, позволяющие делать экспорт в epub, но результат их работы слишком ужастен, чтобы ими пользоваться. Может быть я просто не нашел хороших. Но и программы для экспорта из MS Word есть, так что пользователям Windows не стоит отчаиваться. Я пробовал конвертировать файлы в программе Calibre, это абсолютный маст-хэв в мире электронных книг.
	
2. Экспортированную в epub книгу необходимо "доводить до ума" вручную. Это удобнее всего делать в редакторе Sigil. Вообще, epub файл - это zip-архив, который можно распаковать, а потом редактировать хоть в блокноте. Но Sigil бесплатен и пользоваться им удобнее. К тому-же не всё так просто, в epub файле есть семантические данные, показывающие читалке, где список литературы, где оглавление книги, где обложка и т.п. Добавлять вручную эти семантические данные уже совсем непросто, а в Sigil все делается парой кликов.
	
3. Рисунки нужно вставлять между абзацами. Если рисунок в div-контейнере "с обтеканием", то это будет хорошо работать не везде. Такой текст будет хорошо выглядеть и в простых читалках, где не поддерживаются блоки с обтеканием текста вокруг них и в продвинутых читалках, где это работает.
	
4. Нужно проверять читаемость книги на разных устройствах. Я проверял на PocketBook 301, Alreader на смартфоне и iBooks на iPad. Результаты неутешительные. По неясной причине на PocketBook вместо букв одни вопросики, Alreader не отображает некоторое оформление, а iBooks лучше всех, но он не прощает ошибок в XML (к счастью, Sigil и не даст эти ошибки допустить).

5. Базовое знание CSS совершенно необходимо. Все оформление задаётся в каскадных таблицах стилей, без этого знания можно и не начинать. К счастью, там все просто, в сети легко найти понятные руководства по CSS, так что тут ничего рассказывать не буду. Это все же не настолько просто, чтобы уложиться в пару абзацев.

6. Затраты времени на подготовку книги в epub очень велики. Не надейтесь уложиться в пол-часа, даже если есть вычитанный исходник в формате RTF, например. Для приличного результата придется потратить время, просмотреть результат работы, внести кое-какие "последние правки".

7. epub - отличный формат для книг, он даёт широкие возможности для оформления, но в ряде случаев старый, добрый fb2 будет предпочтительным выбором. Если книга представляет собой преимущественно текст, разбитый на главы и подразделы с иллюстрациями и примечаниями и не содержит таких элементов дизайна, как врезки, рисунки с разнообразным обтеканием и т.п., которые хотелось бы сохранить, а также не содержит большого количества разных стилей текста (цитаты, эпиграфы, фрагменты кода не в счет) - fb2 хороший выбор. Наличие в тексте таблиц - это что-то вроде точки бифукации в выборе между этими двумя форматами. Вообще fb2 позволяет включать в текст простые таблицы, но вот уже элементарные структуры с объединением нескольких ячеек в одну работают далеко не во всех читалках fb2, хотя эти функции содержатся в спецификации fb2. Плюс к тому, fb2 по-прежнему широко распространенный формат, но вот инструменты для его создания изрядно устарели. Calibre ужасно конвертирует Word в fb2. Отлично справляется с экспортом программа doc2fb, но для её работы пришлось установить MS Office 2003. Впрочем, результат работы того стоил.

